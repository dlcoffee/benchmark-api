# benchmark-api

### sleep(2000)

```
༼ つ ◕_◕ ༽つ ❯ npm run benchmark

> benchmark-api@1.0.0 benchmark
> autocannon -c 100 -d 5 http://localhost:3000/db

Running 5s test @ http://localhost:3000/db
100 connections


┌─────────┬─────────┬─────────┬─────────┬─────────┬────────────┬─────────┬─────────┐
│ Stat    │ 2.5%    │ 50%     │ 97.5%   │ 99%     │ Avg        │ Stdev   │ Max     │
├─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼─────────┼─────────┤
│ Latency │ 2018 ms │ 2022 ms │ 2035 ms │ 2036 ms │ 2025.57 ms │ 6.17 ms │ 2036 ms │
└─────────┴─────────┴─────────┴─────────┴─────────┴────────────┴─────────┴─────────┘
┌───────────┬─────┬──────┬─────┬─────────┬───────┬─────────┬─────────┐
│ Stat      │ 1%  │ 2.5% │ 50% │ 97.5%   │ Avg   │ Stdev   │ Min     │
├───────────┼─────┼──────┼─────┼─────────┼───────┼─────────┼─────────┤
│ Req/Sec   │ 0   │ 0    │ 0   │ 100     │ 40    │ 48.99   │ 100     │
├───────────┼─────┼──────┼─────┼─────────┼───────┼─────────┼─────────┤
│ Bytes/Sec │ 0 B │ 0 B  │ 0 B │ 25.1 kB │ 10 kB │ 12.3 kB │ 25.1 kB │
└───────────┴─────┴──────┴─────┴─────────┴───────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 5

300 requests in 5.03s, 50.2 kB read
```


### nothing

```
༼ つ ◕_◕ ༽つ ❯ npm run benchmark

> benchmark-api@1.0.0 benchmark
> autocannon -c 100 -d 5 http://localhost:3000/db

Running 5s test @ http://localhost:3000/db
100 connections


┌─────────┬──────┬──────┬───────┬───────┬─────────┬─────────┬────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%   │ Avg     │ Stdev   │ Max    │
├─────────┼──────┼──────┼───────┼───────┼─────────┼─────────┼────────┤
│ Latency │ 5 ms │ 7 ms │ 10 ms │ 12 ms │ 7.59 ms │ 9.54 ms │ 490 ms │
└─────────┴──────┴──────┴───────┴───────┴─────────┴─────────┴────────┘
┌───────────┬────────┬────────┬─────────┬────────┬────────┬────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%     │ 97.5%  │ Avg    │ Stdev  │ Min    │
├───────────┼────────┼────────┼─────────┼────────┼────────┼────────┼────────┤
│ Req/Sec   │ 11,143 │ 11,143 │ 12,615  │ 12,759 │ 12,340 │ 605.58 │ 11,143 │
├───────────┼────────┼────────┼─────────┼────────┼────────┼────────┼────────┤
│ Bytes/Sec │ 2.8 MB │ 2.8 MB │ 3.17 MB │ 3.2 MB │ 3.1 MB │ 151 kB │ 2.8 MB │
└───────────┴────────┴────────┴─────────┴────────┴────────┴────────┴────────┘

Req/Bytes counts sampled once per second.
# of samples: 5

62k requests in 5.02s, 15.5 MB read
```

### db trx with sleep and limited connections

```
༼ つ ◕_◕ ༽つ ❯ npm run benchmark

> benchmark-api@1.0.0 benchmark
> autocannon -c 100 -d 5 http://localhost:3000/db

Running 5s test @ http://localhost:3000/db
100 connections


┌─────────┬─────────┬─────────┬─────────┬─────────┬────────────┬───────────┬─────────┐
│ Stat    │ 2.5%    │ 50%     │ 97.5%   │ 99%     │ Avg        │ Stdev     │ Max     │
├─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼───────────┼─────────┤
│ Latency │ 1004 ms │ 1014 ms │ 1035 ms │ 1036 ms │ 1028.07 ms │ 169.06 ms │ 3393 ms │
└─────────┴─────────┴─────────┴─────────┴─────────┴────────────┴───────────┴─────────┘
┌───────────┬─────┬──────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%  │ 2.5% │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────┼──────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 0   │ 0    │ 98      │ 100     │ 78.8    │ 39.41   │ 98      │
├───────────┼─────┼──────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 0 B │ 0 B  │ 25.6 kB │ 26.1 kB │ 20.6 kB │ 10.3 kB │ 25.6 kB │
└───────────┴─────┴──────┴─────────┴─────────┴─────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 5

0 2xx responses, 394 non 2xx responses
494 requests in 5.03s, 103 kB read
```

### db trx with no sleep and limited connections

```
༼ つ ◕_◕ ༽つ ❯ npm run benchmark

> benchmark-api@1.0.0 benchmark
> autocannon -c 100 -d 5 http://localhost:3000/db

Running 5s test @ http://localhost:3000/db
100 connections


┌─────────┬─────────┬─────────┬─────────┬─────────┬────────────┬──────────┬─────────┐
│ Stat    │ 2.5%    │ 50%     │ 97.5%   │ 99%     │ Avg        │ Stdev    │ Max     │
├─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼──────────┼─────────┤
│ Latency │ 1005 ms │ 1025 ms │ 1046 ms │ 1413 ms │ 1030.48 ms │ 59.36 ms │ 1511 ms │
└─────────┴─────────┴─────────┴─────────┴─────────┴────────────┴──────────┴─────────┘
┌───────────┬─────┬──────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%  │ 2.5% │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────┼──────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 0   │ 0    │ 100     │ 100     │ 80      │ 40      │ 100     │
├───────────┼─────┼──────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 0 B │ 0 B  │ 26.1 kB │ 26.1 kB │ 20.9 kB │ 10.4 kB │ 26.1 kB │
└───────────┴─────┴──────┴─────────┴─────────┴─────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 5

0 2xx responses, 400 non 2xx responses
500 requests in 5.03s, 104 kB read
```


### no db trx

```
༼ つ ◕_◕ ༽つ ❯ npm run benchmark

> benchmark-api@1.0.0 benchmark
> autocannon -c 100 -d 5 http://localhost:3000/db

Running 5s test @ http://localhost:3000/db
100 connections


┌─────────┬────────┬─────────┬─────────┬─────────┬───────────┬───────────┬─────────┐
│ Stat    │ 2.5%   │ 50%     │ 97.5%   │ 99%     │ Avg       │ Stdev     │ Max     │
├─────────┼────────┼─────────┼─────────┼─────────┼───────────┼───────────┼─────────┤
│ Latency │ 547 ms │ 1008 ms │ 1060 ms │ 1072 ms │ 966.77 ms │ 125.52 ms │ 1082 ms │
└─────────┴────────┴─────────┴─────────┴─────────┴───────────┴───────────┴─────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 30      │ 30      │ 100     │ 110     │ 88      │ 29.27   │ 30      │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 7.53 kB │ 7.53 kB │ 25.7 kB │ 28.3 kB │ 22.6 kB │ 7.59 kB │ 7.53 kB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 5

197 2xx responses, 243 non 2xx responses
540 requests in 5.03s, 113 kB read
```
